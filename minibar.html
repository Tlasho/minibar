<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Minibar - Inventory System</title>
<script src="nozoom.js"></script>
<style>
/* ... Your previous CSS goes here (unchanged) ... */
</style>
</head>
<body>

<!-- CHARGER/CABLE BUTTONS -->
<div class="charger-buttons-container" id="chargerButtons">
  <button class="charger-btn" id="chargerBtn">
    <span>Charger</span>
  </button>
  <button class="charger-btn" id="cableBtn">
    <span>Charging Cable</span>
  </button>
</div>

<!-- SETTINGS MENU -->
<div class="settings-menu" id="settingsMenu">
  <div class="settings-button" id="settingsButton">â‹®</div>
  <div class="settings-panel" id="settingsPanel">
    <div class="settings-item" id="viewInventory">
      <span>ğŸ“‹</span>
      <span>áƒ¨áƒ”áƒ•áƒ¡áƒ”áƒ‘áƒ</span>
    </div>
  </div>
</div>

<!-- LOGIN SCREEN -->
<div class="login-screen" id="loginScreen">
  <div class="login-container">
    <h1 class="login-title">áƒ›áƒ˜áƒœáƒ˜áƒ‘áƒáƒ áƒ˜</h1>
    <p class="login-subtitle">áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ”áƒ— áƒáƒ—áƒáƒ®áƒ˜áƒ¡ áƒœáƒáƒ›áƒ”áƒ áƒ˜</p>
    
    <input type="text" class="room-input" id="roomInput" placeholder="(áƒ›áƒ’. 101 áƒáƒœ 2201)" maxlength="4" autofocus>
    <button class="login-button" id="loginButton">áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ</button>
    <div style="margin-top: 25px;">
      <a href="minus.html" style="display: block; padding: 12px 20px; background: #ef4444; color: white; text-decoration: none; border-radius: 12px; border: 2px solid #000000; font-size: 17px; text-align: center; font-weight: bold;">
        áƒ›áƒ˜áƒœáƒ£áƒ¡áƒ”áƒ‘áƒ˜
      </a>
    </div>
    
    <div class="error-message" id="errorMessage"></div>
    <div class="valid-rooms">
      <div class="room-category">áƒáƒ—áƒáƒ®áƒ”áƒ‘áƒ˜</div>
      <div>áƒáƒ˜áƒ áƒ•áƒ”áƒšáƒ˜: 101-124</div>
      <div>áƒ›áƒ”áƒáƒ áƒ”: 201-224</div>
      <div>áƒ›áƒ”áƒ¡áƒáƒ›áƒ”: 301-324</div>
      <div>áƒ›áƒ”áƒáƒ—áƒ®áƒ”: 401-410</div>
      <div>áƒáƒ˜áƒ áƒ•áƒ”áƒšáƒ˜(áƒ«áƒ•): 2201-2214</div>
      <div>áƒ›áƒ”áƒáƒ áƒ”(áƒ«áƒ•): 3301-3314</div>
      <div style="margin-top: 10px; color: #fbbf24;">áƒ™áƒáƒ–áƒ˜áƒœáƒáƒ¡ áƒáƒ—áƒáƒ®áƒ”áƒ‘áƒ˜: 103, 105, 112, 203, 205, 212, 312, 401-410</div>
    </div>
    
    <a href="inventory.html" style="display: block; padding: 12px 12px; background: #157e3e; color: white; text-decoration: none; border-radius: 12px; border: 2px solid #000000; font-size: 17px; text-align: center; font-weight: bold;">
      áƒ¨áƒ”áƒ•áƒ¡áƒ”áƒ‘áƒ
    </a>
  </div>
</div>

<!-- ROOM NUMBER DISPLAY -->
<div class="room-display" id="roomDisplay">
  <span>áƒáƒ—áƒáƒ®áƒ˜</span>
  <span id="roomNumberDisplay">000</span>
  <div class="casino-badge" id="casinoBadge" style="display: none;">CASINO</div>
</div>

<!-- DONE BUTTON -->
<button class="done-button" id="doneButton">
  <span>âœ“</span>
  <span>Done</span>
</button>

<div class="back-arrow" id="backArrow">â†</div>
<div class="shelf-background" id="shelfBackground"></div>

<!-- PRODUCTS CONTAINER -->
<div class="products-container" id="productsContainer"></div>

<div class="center-container" id="centerContainer">
  <div class="minibar" id="bar" style="--shelf-top: 35%">
    <div class="box">
        <div class="inside">
          <div class="shelf-area above" data-area="above"></div>
          <div class="shelf-area below" data-area="below"></div>
          <div class="shelf"></div>
        </div>
        <div class="door">
          <div class="door-front"></div>
          <div class="door-back">
            <div class="door-inner">
              <div class="door-shelf one" data-shelf="door-1"></div>
              <div class="door-shelf two" data-shelf="door-2"></div>
            </div>
          </div>
        </div>
    </div>
  </div>
</div>

<script>
// --- Inventory Manager (unchanged) ---
const InventoryManager = {
  init() {
    if (!localStorage.getItem('minibarInventory')) localStorage.setItem('minibarInventory', JSON.stringify({}));
  },
  getAllInventory() { return JSON.parse(localStorage.getItem('minibarInventory')||'{}'); },
  getRoomInventory(room) { return this.getAllInventory()[room]||{products:{}}; },
  updateProductCount(room, id, name, count) {
    const all = this.getAllInventory();
    if (!all[room]) all[room]={products:{},lastUpdated:new Date().toISOString()};
    if(count>0){all[room].products[id]={name,count,lastUpdated:new Date().toISOString()};}
    else{delete all[room].products[id];}
    all[room].lastUpdated=new Date().toISOString();
    localStorage.setItem('minibarInventory', JSON.stringify(all));
  },
  getProductCount(room,id){ return this.getRoomInventory(room).products[id]?.count||0; }
};
InventoryManager.init();

// --- DOM Elements ---
const loginScreen=document.getElementById("loginScreen");
const roomInput=document.getElementById("roomInput");
const loginButton=document.getElementById("loginButton");
const errorMessage=document.getElementById("errorMessage");
const centerContainer=document.getElementById("centerContainer");
const bar=document.getElementById("bar");
const backArrow=document.getElementById("backArrow");
const shelfBackground=document.getElementById("shelfBackground");
const productsContainer=document.getElementById("productsContainer");
const roomDisplay=document.getElementById("roomDisplay");
const roomNumberDisplay=document.getElementById("roomNumberDisplay");
const casinoBadge=document.getElementById("casinoBadge");
const doneButton=document.getElementById("doneButton");

let currentRoom=null;
let currentShelfId=null;
let areProductsOpen=false;

// --- Products Data (unchanged) ---
const baseProducts = {
  'above': [{ id:1,name:"Cola",image:"https://product.hstatic.net/1000282430/product/nuoc-ngot-coca-cola-nhat-500ml_f61289e9a50d41398d9711800846f9b0_grande.jpg", maxCount:1 }],
  'below': [{ id:7,name:"Water",image:"https://www.aversi.ge/uploads/matimg/293a37597e5b2ad1120984e131d7e82a.jpg", maxCount:100 }]
};

// --- PRODUCT CLICK HANDLER FIX ---
function createProductElement(product){
  const el=document.createElement('div');
  el.className='product';
  el.setAttribute('data-product-id',product.id);
  el.setAttribute('data-product-name',product.name);
  el.setAttribute('data-max-count',product.maxCount);

  el.innerHTML=`<div class="product-name">${product.name}</div>
                <img src="${product.image}" class="product-image" alt="${product.name}">
                <div class="product-quantity">${InventoryManager.getProductCount(currentRoom, product.id)}</div>`;

  const qtyEl=el.querySelector('.product-quantity');

  el.addEventListener('click',()=>{
    let count=InventoryManager.getProductCount(currentRoom, product.id);
    if(count<product.maxCount) count++; else count=0;
    InventoryManager.updateProductCount(currentRoom, product.id, product.name, count);
    qtyEl.textContent=count;
  });

  return el;
}

// --- Show products ---
function showProducts(shelfId){
  currentShelfId=shelfId;
  productsContainer.innerHTML='';
  const products=[...(baseProducts[shelfId]||[])];
  products.forEach(p=>productsContainer.appendChild(createProductElement(p)));
  productsContainer.style.opacity='1';
  productsContainer.style.visibility='visible';
  backArrow.style.display='block';
  areProductsOpen=true;
}

// --- LOGIN ---
loginButton.addEventListener('click',()=>{
  const room=roomInput.value.trim();
  if(!room){errorMessage.textContent='Please enter a room'; return;}
  currentRoom=room;
  loginScreen.style.display='none';
  centerContainer.style.display='flex';
  roomDisplay.style.opacity='1';
  roomNumberDisplay.textContent=room;
});

// --- SHELF CLICK ---
document.querySelectorAll('.shelf-area').forEach(area=>{
  area.addEventListener('click',()=>showProducts(area.dataset.area));
});

document.querySelectorAll('.door-shelf').forEach(shelf=>{
  shelf.addEventListener('click',()=>showProducts(shelf.dataset.shelf));
});
</script>
</body>
</html>
